---
import '../styles/global.css';

interface Props {
  title: string;
  description?: string;
  image?: string;
  canonicalURL?: string;
  type?: 'website' | 'article';
  publishedTime?: string;
  modifiedTime?: string;
  author?: string;
  section?: string;
  tags?: string[];
}

const { 
  title = 'PulseTrack | Analytics en Tiempo Real para tu Negocio',
  description = 'Monitorea, analiza y optimiza el rendimiento de tu sitio web con PulseTrack. Obtén insights en tiempo real y toma decisiones basadas en datos para hacer crecer tu negocio.',
  image = '/social.png',
  canonicalURL,
  type = 'website',
  publishedTime,
  modifiedTime,
  author = 'PulseTrack',
  section = 'Analytics',
  tags = ['analytics', 'web analytics', 'tracking', 'estadísticas web', 'rendimiento web']
} = Astro.props;

const fullCanonicalURL = canonicalURL ? new URL(canonicalURL, Astro.site) : Astro.url;
const fullImageURL = new URL(image, Astro.site);

 const schemaOrgJSONLD = {
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "PulseTrack",
  "url": Astro.site,
  "description": description,
  "applicationCategory": "AnalyticsApplication",
  "operatingSystem": "Web",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "creator": {
    "@type": "Organization",
    "name": "PulseTrack"
  }
};
---

<!DOCTYPE html>
<html lang="es" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
    
    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="keywords" content="analytics, web analytics, tracking, estadísticas web, métricas, rendimiento web, conversiones, embudos, eventos, heatmaps, análisis de audiencia" />
    <meta name="author" content={author} />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href={fullCanonicalURL} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content={type} />
    <meta property="og:url" content={fullCanonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={fullImageURL} />
    <meta property="og:site_name" content="PulseTrack" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={fullCanonicalURL} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={fullImageURL} />
    
    <!-- Additional Meta Tags -->
    {type === 'article' && publishedTime && <meta property="article:published_time" content={publishedTime} />}
    {type === 'article' && modifiedTime && <meta property="article:modified_time" content={modifiedTime} />}
    {type === 'article' && author && <meta property="article:author" content={author} />}
    {type === 'article' && section && <meta property="article:section" content={section} />}
    {type === 'article' && tags.length > 0 && tags.map(tag => (
      <meta property="article:tag" content={tag} />
    ))}
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180" />
    
    <!-- Structured Data -->
    <script type="application/ld+json">
      {JSON.stringify(schemaOrgJSONLD)}
    </script>
    
    <slot name="head" />
  </head>
  <body class="min-h-screen bg-white text-gray-900 antialiased">
    <slot />

    <script src="https://cdn.jsdelivr.net/gh/Chikavi1/pulsetrack@master/dist/pulsetrack.umd.min.js"></script>
    <script type="module">
      window.addEventListener('load', () => {
        const pt = window.PulseTrack?.PulseTrack;
        if (!pt) return;
        pt.init({
          businessId: '080fbac4-2aa8-4016-89ee-e339bd3c1c16'
        });
      });  
    </script>
    


  </body>
</html>
